# control_base_system
## 总述：
用于存储并管理呼吸传感器的读取与数据处理，以及外设的操作信息；之后可能会继续附加详细的控制与显示功能。
## 功能表述：
- for_Arduino文件夹存放基于Arduino Nano ESP32单片机的基本控制程序，已经可以完成对2个XGZP气压计、1个ACD1100二氧化碳传感器、1个AO08氧气传感器进行读取的代码，此外还含有ADS1115、I2CMux转接以及OLED设备的控制代码；
    - XGZP气压计：可以读取数据，但是ADC值转化函数有误，需要重新校准；仅支持I2C通讯。[BreathController库]
    - ACD1100二氧化碳传感器：可以读取数据且比较准确，目前来看应该是最可靠的元件；可以支持I2C通讯以及UART通讯，当前使用I2C通讯。[gas_concentration库]
    - AO08氧气传感器（TRS线路）：暂时读不到合理的数据，硬件线路可能还需要调试。目前使用的是ADS1115读取方案，与技术手册中直接使用运算放大器的方案不同（因为运放没办法装在面包板上），读不到合理数据有可能与此有关。ADS1115使用I2C通讯，通过差分方式读取数据，且对信号（理论上为9~13mV）进行增益放大。[该硬件由独立程序控制，见AO08_Calibration_Test文件夹]
    - 流量计：之前编写过代码，但已经废弃，最好重新编写后进行调试。
    - ADS1115：一款16位精度的ADC，同时支持大增益，可以在转化信号的同时放大信号。因此，也有放大噪声的可能性。[ADS1115库]
    - I2C多路转接板：由于需要使用I2C通讯方式的硬件较多，因此使用转接板来提供多路选择。该板的通讯地址为0x70，共有8个拓展位可选，所有硬件的接口设置在主代码中可见。[I2CMux库]
    - OLED：一个12864的OLED小屏幕，需要显示什么信息直接在库对应的cpp文件中修改即可。[OLEDDisplay库]
    - 综上，各元件的具体参数详见各技术手册，如果没有技术手册请直接搜素；代码中可能存在一些没有完全删除的废码，通常不影响使用；如果希望删改或添加功能，建议使用AI，否则改动量还是比较大的。
- for_linux文件夹存放基于Luckfox Lyra Zero W嵌入式linux开发板，性能基本远超Arduino板，缺点在于编译比较麻烦。如果想尝试的话，需要准备ubuntu系统（或者你也可以试试WSL，理论上可以），通过运行于ubuntu的SDK编译链将库文件编译为烧录用的映像文件；通过ubuntu的交叉编译链将程序编译为二进制文件；通过嵌入式linux开发板上的luckfox-config程序调试串口，之后上传数据并赋予exe尾缀，即可运行，目前迁移的原程序均可以运行。如果像在此平台上继续编辑，请参看官方wiki文档https://wiki.luckfox.com/zh/Luckfox-Lyra/
    - AO08_linux_port文件夹：迁移后的AO08对应的程序，但还是C语言形式，没有通过交叉编译为二进制文件。
    - binary_data文件夹：存放编译好的二进制文件。
    - linux_port文件夹：迁移后的主程序对应程序，但还是C语言形式，没有通过交叉编译为二进制文件，并且其中包括了开发板的HAL硬件库LuckfoxArduino.h。
    - qt5_gui文件夹：内含Qt库可视化的对应文件，但是还没有完全实现。
    - SDK文件夹：内含烧录用的映像文件。
### [2025-12-7更新]  
- 现在气压计已经可以正常读数，不过注意差压计读数法，即原始读数为0。
- 流量计可以正常使用，但是注意需要整合在begin以及update中，或者单独准备一个函数。
### [2025-12-18更新]  
- I2C_FINAL_DEMO文件夹中是整合后的基本采集系统。
- 注意，该系统只有采集和显示功能，并不能实现对数据本身的有效处理。
